#!/bin/bash

mkvextract tracks "/home/team/torrents/Porco.Rosso.1992.MULTi.1080p.BluRay.x264-ULSHD.mkv" 3:/home/team/torrents/1.srt  > /home/team/torrents/extract.logs && mv /home/team/torrents/extract.logs /home/team/torrents/_extract.logs && ffmpeg -y -i /home/team/torrents/1.srt /home/team/torrents/1.ass && sed -i 's/Style: Default,Arial,16,\&Hffffff,\&Hffffff,\&H0,\&H0,0,0,0,1,1,0,2,10,10,10,0,0/Style: Default,Verdana,20,\&H00FFFFFF,\&H00000000,\&H00000000,\&H00000000,-1,0,0,0,100,100,0,0,1,2,2,2,15,15,15,0/g' /home/team/torrents/1.ass && sed -i 's/Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, AlphaLevel, Encoding/Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic,  Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding/g' /home/team/torrents/1.ass && ffmpeg -y -vstats_file "/home/team/torrents/Porco.Rosso.1992.VOSTFR.BRRiP.x264.AC3-CiRAR.mkv.vstats" -i "/home/team/torrents/Porco.Rosso.1992.MULTi.1080p.BluRay.x264-ULSHD.mkv" -an -vcodec libx264 -b:v 1648024 -s 720x384 -vf "ass=/home/team/torrents/1.ass" -preset slow -tune film -profile:v high -level 3.1 -threads 0 -pass 1 -passlogfile pass1.log pass1.h264 > /var/www/ogmrip/logs/905efa10661e2c5bc9e1de7750311b92.pass1a.logs 2> /var/www/ogmrip/logs/905efa10661e2c5bc9e1de7750311b92.pass1b.logs && ffmpeg -y -vstats_file "/home/team/torrents/Porco.Rosso.1992.VOSTFR.BRRiP.x264.AC3-CiRAR.mkv.vstats" -i "/home/team/torrents/Porco.Rosso.1992.MULTi.1080p.BluRay.x264-ULSHD.mkv" -map 0:0 -map 0:2 -metadata:s:v:0:0 title='' -c:v:0:0 libx264 -b:v:0:0 1648024 -s:v:0:0 720x384 -vf "ass=/home/team/torrents/1.ass" -preset:v slow -tune film -profile:v high -level 3.1 -metadata:s:a:0:2 title="" -metadata:s:a:0:2 language='jpn' -c:a:0:2 ac3 -b:a:0:2 448000 -threads 0 -pass 2 -passlogfile pass1.log "/home/team/torrents/Porco.Rosso.1992.VOSTFR.BRRiP.x264.AC3-CiRAR.mkv" > /var/www/ogmrip/logs/905efa10661e2c5bc9e1de7750311b92.pass2a.logs 2> /var/www/ogmrip/logs/905efa10661e2c5bc9e1de7750311b92.pass2b.logs && mkvpropedit "/home/team/torrents/Porco.Rosso.1992.VOSTFR.BRRiP.x264.AC3-CiRAR.mkv" --edit info --set "title=Encoded by CiRAR bot v1.5 - Porco.Rosso.1992.VOSTFR.BRRiP.x264.AC3-CiRAR"
php -f /var/www/ogmrip/terminate_encode.php "905efa10661e2c5bc9e1de7750311b92"